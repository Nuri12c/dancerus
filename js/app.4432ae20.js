(function(){"use strict";var t={7364:function(t,e,s){t.exports=s.p+"img/Profile.fc756474.png"},8764:function(t,e,s){var o=s(5130),n=s(2261),i=s(6768);function a(t,e,s,o,n,a){const r=(0,i.g2)("HeaderApp"),c=(0,i.g2)("GuestContent"),l=(0,i.g2)("DashboardModal"),d=(0,i.g2)("RegisterModal"),h=(0,i.g2)("CodeInputModal"),u=(0,i.g2)("LoginModal"),p=(0,i.g2)("AuthModal");return(0,i.uX)(),(0,i.CE)("div",null,[(0,i.bF)(r,{token:o.authStore.token,onOpenRegister:e[0]||(e[0]=t=>n.showRegister=!0),onOpenLogin:e[1]||(e[1]=t=>n.showLogin=!0),onOpenAuthModal:e[2]||(e[2]=t=>n.showAuthModal=!0),onOpenDashboard:e[3]||(e[3]=t=>n.showDashboard=!0),onSwitchToSite:a.switchToSite,onLogout:a.logout},null,8,["token","onSwitchToSite","onLogout"]),n.showDashboard?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(c,{key:0})),n.showDashboard?((0,i.uX)(),(0,i.Wv)(l,{key:1,"amocrm-data":n.amocrmData},null,8,["amocrm-data"])):(0,i.Q3)("",!0),n.showRegister?((0,i.uX)(),(0,i.Wv)(d,{key:2,phone:n.registerPhone,"onUpdate:phone":e[4]||(e[4]=t=>n.registerPhone=t),onClose:a.closeAll,onRegistered:a.handleRegistered},null,8,["phone","onClose","onRegistered"])):(0,i.Q3)("",!0),n.showCodeInput?((0,i.uX)(),(0,i.Wv)(h,{key:3,phone:n.registerPhone,password:n.tempPassword,isRestore:n.isRestore,onClose:a.closeAll,onVerified:a.handleVerified},null,8,["phone","password","isRestore","onClose","onVerified"])):(0,i.Q3)("",!0),n.showLogin?((0,i.uX)(),(0,i.Wv)(u,{key:4,onClose:a.closeAll,onLoggedIn:a.handleLoggedIn,onRestoreInitiated:a.handleRestore},null,8,["onClose","onLoggedIn","onRestoreInitiated"])):(0,i.Q3)("",!0),n.showAuthModal?((0,i.uX)(),(0,i.Wv)(p,{key:5,onClose:a.closeAll,onOpenLogin:e[5]||(e[5]=t=>{n.showLogin=!0,n.showAuthModal=!1}),onOpenRegister:e[6]||(e[6]=t=>{n.showRegister=!0,n.showAuthModal=!1})},null,8,["onClose"])):(0,i.Q3)("",!0)])}const r=(0,n.nY)("auth",{state:()=>({token:localStorage.getItem("token")||null}),getters:{isAuthenticated:t=>!!t.token},actions:{setToken(t){this.token=t,localStorage.setItem("token",t)},clearToken(){this.token=null,localStorage.removeItem("token")}}});var c=s(4232);const l={class:"buttons"};function d(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("header",{class:(0,c.C4)(["header",{fixed:n.isFixed}])},[e[2]||(e[2]=(0,i.Lk)("div",{class:"logo"},[(0,i.Lk)("div",{class:"icon"}),(0,i.Lk)("h3",{class:"logo__text"},"Танцуй, Россия")],-1)),(0,i.Lk)("div",l,[e[1]||(e[1]=(0,i.Fv)('<button class="button-3">Главная</button><button class="button-3">Все конкурсы</button><button class="button-3">Подать заявку</button><button class="button-3">Новости</button><button class="watsapp-button"></button>',5)),(0,i.Lk)("button",{class:"button-2",onClick:e[0]||(e[0]=(...t)=>a.handleCabinetClick&&a.handleCabinetClick(...t))},(0,c.v_)(s.token?"Выйти":"Личный кабинет"),1)])],2)}var h={props:{token:String},data(){return{isFixed:!1}},methods:{handleCabinetClick(){this.token?this.$emit("logout"):this.$emit("open-auth-modal")},handleScroll(){this.isFixed=window.scrollY>40}},mounted(){window.addEventListener("scroll",this.handleScroll)},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll)}},u=s(1241);const p=(0,u.A)(h,[["render",d]]);var _=p;function m(t,e,s,o,n,a){const r=(0,i.g2)("sectionHero"),c=(0,i.g2)("sectionContest"),l=(0,i.g2)("sectionRevievs"),d=(0,i.g2)("sectionWhy"),h=(0,i.g2)("sectionGroup");return(0,i.uX)(),(0,i.CE)("body",null,[(0,i.bF)(r),(0,i.bF)(c),(0,i.bF)(l),(0,i.bF)(d),(0,i.bF)(h)])}const v={class:"hero"};function g(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("section",v,e[0]||(e[0]=[(0,i.Fv)('<div class="hero__container"><h1 class="hero__heading"> Международное хореографическое <br>движение «Танцуй, Россия» </h1><div class="hero__content"><div class="hero__text"><p><b>Миссия:</b> Помогать, поддерживать и приносить реальную пользу каждому ребенку, педагогу и коллективу, стремящемуся к развитию в мире хореографии. Мы создаём доступную и вдохновляющую среду,где талант может расти, а усилия — превращаться в результат.</p><p><b>Цель:</b> Не просто конкурсы, а путь, по которому дети обретают уверенность, педагоги —поддержку, а коллективы — возможности для роста, признания и новых горизонтов.</p></div><button class="button-1">Подать заявку</button></div></div>',1)]))}var w={};const k=(0,u.A)(w,[["render",g]]);var f=k,b=s.p+"img/liveStream.91162f4b.png",L=s.p+"img/OchnoeStream.dffc606d.png",C=s.p+"img/polufinalStream.48414a6c.png",y=s.p+"img/tochkaVzleta.0fe3c736.png",T=s.p+"img/4fest.4f57bf91.png",R=s.p+"img/konkurent.1737b96e.png";const S={class:"contest"};function P(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("section",S,e[0]||(e[0]=[(0,i.Fv)('<h2 class="contest__title">Наши конкурсы</h2><ul class="contest__cards"><li class="contest__card"><img src="'+b+'" alt="ПРЯМОЕ ВКЛЮЧЕНИЕ В ПРЯМОМ ЭФИРЕ" class="contest__img-element"><div class="contest__content"><div class="contest__text"><div class="contest__heading">ПРЯМОЕ ВКЛЮЧЕНИЕ В ПРЯМОМ ЭФИРЕ</div><div class="contest__date">12-13 сентября</div></div><div class="contest__button"><button class="contest__button-element">Узнать подробнее</button><span class="contest__button-icon"></span></div></div></li><li class="contest__card"><img src="'+L+'" alt="ПРЯМОЕ ВКЛЮЧЕНИЕ ОТБОРОЧНЫЙ ЭТАП" class="contest__img-element"><div class="contest__content"><div class="contest__text"><div class="contest__heading">ПРЯМОЕ ВКЛЮЧЕНИЕ ОТБОРОЧНЫЙ ЭТАП</div><div class="contest__date">20-21 октября</div></div><div class="contest__button"><button class="contest__button-element">Узнать подробнее</button><span class="contest__button-icon">&gt;</span></div></div></li><li class="contest__card"><img src="'+C+'" alt="ПРЯМОЕ ВКЛЮЧЕНИЕ ПОЛУФИНАЛ" class="contest__img-element"><div class="contest__content"><div class="contest__text"><div class="contest__heading">ПРЯМОЕ ВКЛЮЧЕНИЕ ПОЛУФИНАЛ</div><div class="contest__date">15-16 ноября</div></div><div class="contest__button"><button class="contest__button-element">Узнать подробнее</button><span class="contest__button-icon">&gt;</span></div></div></li><li class="contest__card"><img src="'+y+'" alt="ТОЧКА ВЗЛЕТА ФИНАЛ" class="contest__img-element"><div class="contest__content"><div class="contest__text"><div class="contest__heading">ТОЧКА ВЗЛЕТА ФИНАЛ</div><div class="contest__date">10-11 декабря</div></div><div class="contest__button"><button class="contest__button-element">Узнать подробнее</button><span class="contest__button-icon">&gt;</span></div></div></li><li class="contest__card"><img src="'+T+'" alt="4FEST" class="contest__img-element"><div class="contest__content"><div class="contest__text"><div class="contest__heading">4FEST</div><div class="contest__date">18-19 января</div></div><div class="contest__button"><button class="contest__button-element">Узнать подробнее</button><span class="contest__button-icon">&gt;</span></div></div></li><li class="contest__card"><img src="'+R+'" alt="КОНКУРЕНТ" class="contest__img-element"><div class="contest__content"><div class="contest__text"><div class="contest__heading">КОНКУРЕНТ</div><div class="contest__date">25-26 февраля</div></div><div class="contest__button"><button class="contest__button-element">Узнать подробнее</button><span class="contest__button-icon">&gt;</span></div></div></li></ul>',2)]))}var A={};const D=(0,u.A)(A,[["render",P]]);var I=D,x=s.p+"img/Shape.fe62b5b1.svg";const E={class:"reviews"},X={class:"reviews__card"},F={class:"reviews__heading"},O={class:"reviews__text"},M={class:"reviews__autor"},$=["src","alt"],W={class:"autor__card"},G={class:"autor__card-text"},V={class:"autor__card-city"},j={class:"reviews__controls"},B={class:"reviews__counter"},Q={class:"reviews__buttons"};function U(t,e,s,o,n,a){const r=(0,i.g2)("swiper-slide"),l=(0,i.g2)("swiper");return(0,i.uX)(),(0,i.CE)("section",E,[e[3]||(e[3]=(0,i.Lk)("h2",{class:"reviews__title"},"ОТЗЫВЫ",-1)),(0,i.bF)(l,{modules:[o.Navigation],"slides-per-view":3,"space-between":o.spaceBetween,"allow-touch-move":!0,breakpoints:{320:{slidesPerView:1},768:{slidesPerView:2},1024:{slidesPerView:3}},onSwiper:a.onSwiper,onSlideChange:a.updateCounter},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.reviews,(t,s)=>((0,i.uX)(),(0,i.Wv)(r,{key:s},{default:(0,i.k6)(()=>[(0,i.Lk)("div",X,[e[2]||(e[2]=(0,i.Lk)("div",{class:"reviews__card-stars"},[(0,i.Lk)("img",{src:x,alt:""}),(0,i.Lk)("img",{src:x,alt:""}),(0,i.Lk)("img",{src:x,alt:""}),(0,i.Lk)("img",{src:x,alt:""}),(0,i.Lk)("img",{src:x,alt:""})],-1)),(0,i.Lk)("p",F,(0,c.v_)(t.heading),1),(0,i.Lk)("p",O,(0,c.v_)(t.text),1),(0,i.Lk)("div",M,[(0,i.Lk)("img",{class:"reviews__author-img",src:t.img,alt:t.author},null,8,$),(0,i.Lk)("div",W,[(0,i.Lk)("p",G,(0,c.v_)(t.author),1),(0,i.Lk)("p",V,(0,c.v_)(t.city),1)])])])]),_:2},1024))),128))]),_:1},8,["modules","space-between","onSwiper","onSlideChange"]),(0,i.Lk)("div",j,[(0,i.Lk)("span",B,(0,c.v_)(n.currentGroup)+" из "+(0,c.v_)(n.totalGroups),1),(0,i.Lk)("div",Q,[(0,i.Lk)("button",{class:"reviews__button reviews__button--prev",onClick:e[0]||(e[0]=(...t)=>a.slidePrev&&a.slidePrev(...t))}),(0,i.Lk)("button",{class:"reviews__button reviews__button--next rotate",onClick:e[1]||(e[1]=(...t)=>a.slideNext&&a.slideNext(...t))})])])])}var J=s(144),N=s(8421),z=s(5315),H={name:"ReviewsSlider",components:{Swiper:N.RC,SwiperSlide:N.qr},setup(){const t=[{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)},{heading:"Отличные конкурсы!",text:"Выгодное в соотношении качества/цены, главное, что поддержка коллектива идет на каждом этапе конкурса, все понятно доносят, условия проживания комфортные, команада “Танцуй, Россия” очень отзычивая.",author:"Андрей Курносов",city:"Москва, Россия",img:s(7364)}],e=(0,J.KR)(Math.round(.02*window.innerWidth)),o=()=>{e.value=Math.round(.02*window.innerWidth)};return(0,i.sV)(()=>{window.addEventListener("resize",o)}),(0,i.xo)(()=>{window.removeEventListener("resize",o)}),{reviews:t,Navigation:z.Vx,spaceBetween:e}},data(){return{currentGroup:1,totalGroups:3,swiperInstance:null}},methods:{onSwiper(t){this.swiperInstance=t},slideNext(){this.swiperInstance&&this.swiperInstance.slideTo(this.swiperInstance.activeIndex+3)},slidePrev(){this.swiperInstance&&this.swiperInstance.slideTo(this.swiperInstance.activeIndex-3)},updateCounter(){this.swiperInstance&&(this.currentGroup=Math.floor(this.swiperInstance.activeIndex/3)+1)}}};const K=(0,u.A)(H,[["render",U],["__scopeId","data-v-0be72a62"]]);var Y=K;const q={class:"why__container"},Z={class:"why__cards"},tt={class:"why__card"},et={class:"why__card"},st={class:"why__card"},ot={class:"why__card"},nt={class:"why__card"},it={class:"why__card"};function at(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("div",q,[e[0]||(e[0]=(0,i.Lk)("h2",{class:"why__title"},"ПОЧЕМУ НАС ВЫБИРАЮТ?",-1)),(0,i.Lk)("div",Z,[(0,i.Lk)("div",tt,[(0,i.RG)(t.$slots,"card-1",{},void 0,!0)]),(0,i.Lk)("div",et,[(0,i.RG)(t.$slots,"card-2",{},void 0,!0)]),(0,i.Lk)("div",st,[(0,i.RG)(t.$slots,"card-3",{},void 0,!0)]),(0,i.Lk)("div",ot,[(0,i.RG)(t.$slots,"card-4",{},void 0,!0)]),(0,i.Lk)("div",nt,[(0,i.RG)(t.$slots,"card-5",{},void 0,!0)]),(0,i.Lk)("div",it,[(0,i.RG)(t.$slots,"card-6",{},void 0,!0)])])])}var rt={};const ct=(0,u.A)(rt,[["render",at],["__scopeId","data-v-0b469f4a"]]);var lt=ct;const dt={class:"group__container"},ht={class:"group__cards"},ut={class:"group__card group__card--left"},pt={class:"group__cards-right"},_t={class:"group__card group__card--right-top"},mt={class:"group__card group__card--right-bottom"};function vt(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("div",dt,[e[0]||(e[0]=(0,i.Lk)("h2",{class:"group__title"},"Сообщество “Танцуй, Россия”",-1)),(0,i.Lk)("div",ht,[(0,i.Lk)("div",ut,[(0,i.RG)(t.$slots,"card-left",{},void 0,!0)]),(0,i.Lk)("div",pt,[(0,i.Lk)("div",_t,[(0,i.RG)(t.$slots,"card-right-top",{},void 0,!0)]),(0,i.Lk)("div",mt,[(0,i.RG)(t.$slots,"card-right-bottom",{},void 0,!0)])])])])}var gt={};const wt=(0,u.A)(gt,[["render",vt],["__scopeId","data-v-4d3c2252"]]);var kt=wt,ft={components:{sectionHero:f,sectionContest:I,sectionRevievs:Y,sectionWhy:lt,sectionGroup:kt}};const bt=(0,u.A)(ft,[["render",m]]);var Lt=bt;const Ct={class:"register-modal"},yt={key:0,class:"register-modal__toast"};function Tt(t,e,s,n,a,r){return(0,i.uX)(),(0,i.CE)("div",Ct,[e[5]||(e[5]=(0,i.Lk)("h2",{class:"register-modal__title"},"Регистрация",-1)),(0,i.bo)((0,i.Lk)("input",{class:"register-modal__input","onUpdate:modelValue":e[0]||(e[0]=t=>a.localPhone=t),placeholder:"+7 900 000 00 00",onInput:e[1]||(e[1]=(...t)=>r.formatPhone&&r.formatPhone(...t)),maxlength:"16"},null,544),[[o.Jo,a.localPhone]]),(0,i.bo)((0,i.Lk)("input",{class:"register-modal__input","onUpdate:modelValue":e[2]||(e[2]=t=>a.password=t),type:"password",placeholder:"Пароль"},null,512),[[o.Jo,a.password]]),(0,i.Lk)("button",{class:"register-modal__button",onClick:e[3]||(e[3]=(...t)=>r.register&&r.register(...t))},"Зарегистрироваться"),(0,i.Lk)("button",{class:"register-modal__button",onClick:e[4]||(e[4]=e=>t.$emit("close"))},"Отмена"),a.notification?((0,i.uX)(),(0,i.CE)("div",yt,(0,c.v_)(a.notification),1)):(0,i.Q3)("",!0)])}var Rt={props:{phone:String},setup(){const t=r();return{authStore:t}},data(){return{localPhone:this.phone||"+7 ",password:"",notification:"",notifyTimer:null}},watch:{phone(t){this.localPhone=t||"+7 "},localPhone(t){this.$emit("update:phone",t)}},methods:{showToast(t){this.notification=t,clearTimeout(this.notifyTimer),this.notifyTimer=setTimeout(()=>{this.notification=""},3e3)},formatPhone(){let t=this.localPhone.replace(/\D/g,"");t.startsWith("8")?t="7"+t.slice(1):t.startsWith("77")&&(t="7"+t.slice(2));let e="+7 ";t.length>1&&(e+=t.slice(1,4)),t.length>=4&&(e+=" "+t.slice(4,7)),t.length>=7&&(e+=" "+t.slice(7,9)),t.length>=9&&(e+=" "+t.slice(9,11)),this.localPhone=e.trim()},register(){const t=this.localPhone.replace(/\D/g,"");if(11!==t.length||!this.password)return void this.showToast("Введите корректный номер и пароль");const e="+"+t,s=new FormData;s.append("phone",e),s.append("password",this.password),fetch("https://letsdancescores.tech/api/register.php",{method:"POST",body:s}).then(t=>t.json()).then(t=>{"success"===t.status?(this.showToast("Код отправлен в WhatsApp!"),this.$emit("registered",{phone:e,password:this.password})):this.showToast(t.message||"Ошибка регистрации")}).catch(()=>{this.showToast("Ошибка сети")})}}};const St=(0,u.A)(Rt,[["render",Tt],["__scopeId","data-v-572283cc"]]);var Pt=St;const At={class:"code-input-modal"},Dt={key:1,class:"code-input-modal__toast"};function It(t,e,s,n,a,r){return(0,i.uX)(),(0,i.CE)("div",At,[e[5]||(e[5]=(0,i.Lk)("h2",{class:"code-input-modal__title"},"Введите 4-значный код из WhatsApp",-1)),(0,i.bo)((0,i.Lk)("input",{class:"code-input-modal__input","onUpdate:modelValue":e[0]||(e[0]=t=>a.code=t),maxlength:"4",placeholder:"Код"},null,512),[[o.Jo,a.code]]),s.isRestore?(0,i.bo)(((0,i.uX)(),(0,i.CE)("input",{key:0,class:"code-input-modal__input","onUpdate:modelValue":e[1]||(e[1]=t=>a.newPassword=t),type:"password",placeholder:"Новый пароль"},null,512)),[[o.Jo,a.newPassword]]):(0,i.Q3)("",!0),(0,i.Lk)("button",{class:"code-input-modal__button",onClick:e[2]||(e[2]=(...t)=>r.verifyCode&&r.verifyCode(...t))},"Подтвердить"),(0,i.Lk)("button",{class:"code-input-modal__button",onClick:e[3]||(e[3]=(...t)=>r.resendCode&&r.resendCode(...t))},"Отправить ещё раз"),(0,i.Lk)("button",{class:"code-input-modal__button",onClick:e[4]||(e[4]=e=>t.$emit("close"))},"Отмена"),a.notification?((0,i.uX)(),(0,i.CE)("div",Dt,(0,c.v_)(a.notification),1)):(0,i.Q3)("",!0)])}var xt={props:{phone:String,isRestore:{type:Boolean,default:!1}},setup(){const t=r();return{authStore:t}},data(){return{code:"",newPassword:"",notification:"",notifyTimer:null}},methods:{showToast(t){this.notification=t,clearTimeout(this.notifyTimer),this.notifyTimer=setTimeout(()=>{this.notification=""},3e3)},verifyCode(){if(!this.code||4!==this.code.length)return void this.showToast("Введите 4-значный код");if(this.isRestore&&!this.newPassword)return void this.showToast("Введите новый пароль");const t=new FormData;t.append("phone",this.phone),t.append("code",this.code),this.isRestore&&t.append("new_password",this.newPassword),fetch("https://letsdancescores.tech/api/verify.php",{method:"POST",body:t}).then(t=>t.json()).then(t=>{"success"===t.status&&t.token?(this.authStore.setToken(t.token),this.showToast(this.isRestore?"Пароль успешно изменён!":"Код подтверждён! Вы вошли в систему."),this.$emit("verified",t.token)):this.showToast(t.message||"Ошибка")}).catch(()=>this.showToast("Ошибка сети"))},resendCode(){const t=new FormData;t.append("phone",this.phone),fetch("https://letsdancescores.tech/api/restore_password.php",{method:"POST",body:t}).then(t=>t.json()).then(t=>{"success"===t.status?this.showToast("Код отправлен в WhatsApp!"):this.showToast(t.message||"Ошибка отправки")}).catch(()=>this.showToast("Ошибка сети"))}}};const Et=(0,u.A)(xt,[["render",It]]);var Xt=Et;const Ft={class:"login-modal"},Ot={key:1,class:"login-modal__toast"};function Mt(t,e,s,n,a,r){return(0,i.uX)(),(0,i.CE)("div",Ft,[e[6]||(e[6]=(0,i.Lk)("h2",{class:"login-modal__title"},"Логин",-1)),(0,i.bo)((0,i.Lk)("input",{class:"login-modal__input","onUpdate:modelValue":e[0]||(e[0]=t=>a.phone=t),placeholder:"+7 900 000 00 00",onInput:e[1]||(e[1]=(...t)=>r.formatPhone&&r.formatPhone(...t)),maxlength:"16"},null,544),[[o.Jo,a.phone]]),(0,i.bo)((0,i.Lk)("input",{class:"login-modal__input","onUpdate:modelValue":e[2]||(e[2]=t=>a.password=t),type:"password",placeholder:"Пароль"},null,512),[[o.Jo,a.password]]),(0,i.Lk)("button",{class:"login-modal__button",onClick:e[3]||(e[3]=(...t)=>r.login&&r.login(...t))},"Войти"),a.showRestoreButton?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"login-modal__button",onClick:e[4]||(e[4]=(...t)=>r.restorePassword&&r.restorePassword(...t))},"Восстановить пароль")):(0,i.Q3)("",!0),(0,i.Lk)("button",{class:"login-modal__button",onClick:e[5]||(e[5]=(...t)=>r.close&&r.close(...t))},"Отмена"),a.notification?((0,i.uX)(),(0,i.CE)("div",Ot,(0,c.v_)(a.notification),1)):(0,i.Q3)("",!0)])}var $t={setup(){const t=r();return{authStore:t}},data(){return{phone:"+7 ",password:"",notification:"",notifyTimer:null,showRestoreButton:!1}},methods:{showToast(t){this.notification=t,clearTimeout(this.notifyTimer),this.notifyTimer=setTimeout(()=>{this.notification=""},3e3)},formatPhone(){let t=this.phone.replace(/\D/g,"");t.startsWith("8")?t="7"+t.slice(1):t.startsWith("77")&&(t="7"+t.slice(2));let e="+7 ";t.length>1&&(e+=t.slice(1,4)),t.length>=4&&(e+=" "+t.slice(4,7)),t.length>=7&&(e+=" "+t.slice(7,9)),t.length>=9&&(e+=" "+t.slice(9,11)),this.phone=e.trim()},login(){const t=this.phone.replace(/\D/g,"");if(11!==t.length||!this.password)return this.showToast("Введите корректный номер и пароль"),void(this.showRestoreButton=!1);const e="+"+t,s=new FormData;s.append("phone",e),s.append("password",this.password),fetch("https://letsdancescores.tech/api/login.php",{method:"POST",body:s}).then(t=>t.json()).then(t=>{"success"===t.status&&t.token?(this.authStore.setToken(t.token),this.showToast("Вы успешно вошли!"),this.showRestoreButton=!1,this.$emit("logged-in",t.token)):(this.showToast(t.message||"Ошибка входа"),this.showRestoreButton="Неверный пароль"===t.message)}).catch(()=>{this.showToast("Ошибка сети"),this.showRestoreButton=!1})},restorePassword(){const t=this.phone.replace(/\D/g,"");if(11!==t.length)return this.showToast("Введите корректный номер"),void(this.showRestoreButton=!1);const e="+"+t,s=new FormData;s.append("phone",e),fetch("https://letsdancescores.tech/api/restore_password.php",{method:"POST",body:s}).then(t=>t.json()).then(t=>{"success"===t.status?(this.showToast("Код отправлен в WhatsApp!"),this.showRestoreButton=!1,this.$emit("restore-initiated",{phone:e})):(this.showToast(t.message||"Ошибка восстановления"),this.showRestoreButton=!0)}).catch(()=>{this.showToast("Ошибка сети"),this.showRestoreButton=!0})},close(){this.showRestoreButton=!1,this.notification="",this.$emit("close")}}};const Wt=(0,u.A)($t,[["render",Mt],["__scopeId","data-v-2c7df2cf"]]);var Gt=Wt;const Vt={class:"dashboard"},jt={key:0},Bt={class:"contact"},Qt={key:1};function Ut(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("div",Vt,[e[3]||(e[3]=(0,i.Lk)("h2",null,"Личный кабинет",-1)),e[4]||(e[4]=(0,i.Lk)("p",null,"Добро пожаловать, пользователь!",-1)),s.amocrmData?((0,i.uX)(),(0,i.CE)("div",jt,[e[2]||(e[2]=(0,i.Lk)("h3",null,"Ваши данные в AmoCRM:",-1)),(0,i.Lk)("div",Bt,[(0,i.Lk)("h4",null," Контакт: "+(0,c.v_)(s.amocrmData.name||"Без имени")+" (ID: "+(0,c.v_)(s.amocrmData.id)+") ",1),(0,i.Lk)("ul",null,[(0,i.Lk)("li",null,[e[0]||(e[0]=(0,i.Lk)("strong",null,"ID:",-1)),(0,i.eW)(" "+(0,c.v_)(s.amocrmData.id),1)]),(0,i.Lk)("li",null,[e[1]||(e[1]=(0,i.Lk)("strong",null,"Имя:",-1)),(0,i.eW)(" "+(0,c.v_)(s.amocrmData.name||"Не указано"),1)]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.filteredFields(s.amocrmData.custom_fields_values),t=>((0,i.uX)(),(0,i.CE)("li",{key:t.field_id},[(0,i.Lk)("strong",null,(0,c.v_)(t.field_name)+":",1),(0,i.eW)(" "+(0,c.v_)(a.formatFieldValue(t)),1)]))),128))])])])):((0,i.uX)(),(0,i.CE)("p",Qt,"Нет данных контакта или запрос не выполнен."))])}s(8111),s(2489);var Jt={props:{amocrmData:{type:Object,default:null}},setup(){const t=r();return{authStore:t}},data(){return{allowedFieldIds:[595287,595289,595291]}},methods:{filteredFields(t){return t&&Array.isArray(t)?t.filter(t=>this.allowedFieldIds.includes(t.field_id)):[]},formatFieldValue(t){const e=t.values[0]?.value;return e?"date"===t.field_type||"date_time"===t.field_type?new Date(1e3*e).toLocaleString("ru-RU"):"checkbox"===t.field_type?e?"Да":"Нет":e:"Не указано"}},mounted(){console.log("mounted: amocrmData=",this.amocrmData),console.log("mounted: token from authStore=",this.authStore.token)}};const Nt=(0,u.A)(Jt,[["render",Ut]]);var zt=Nt;const Ht={class:"auth-modal"},Kt={class:"auth-modal__content"};function Yt(t,e,s,o,n,a){return(0,i.uX)(),(0,i.CE)("div",Ht,[(0,i.Lk)("div",Kt,[e[3]||(e[3]=(0,i.Lk)("h2",{class:"auth-modal__title"},"Авторизация",-1)),(0,i.Lk)("button",{class:"auth-modal__button",onClick:e[0]||(e[0]=e=>t.$emit("open-login"))},"Войти"),(0,i.Lk)("button",{class:"auth-modal__button",onClick:e[1]||(e[1]=e=>t.$emit("open-register"))},"Регистрация"),(0,i.Lk)("button",{class:"auth-modal__button",onClick:e[2]||(e[2]=e=>t.$emit("close"))},"Отмена")])])}var qt={emits:["open-login","open-register","close"]};const Zt=(0,u.A)(qt,[["render",Yt],["__scopeId","data-v-4e8ec906"]]);var te=Zt,ee={components:{HeaderApp:_,GuestContent:Lt,RegisterModal:Pt,CodeInputModal:Xt,LoginModal:Gt,DashboardModal:zt,AuthModal:te},data(){return{showRegister:!1,showCodeInput:!1,showLogin:!1,showAuthModal:!1,showDashboard:!1,registerPhone:"",tempPassword:"",isRestore:!1,amocrmData:null}},setup(){const t=r();return{authStore:t}},methods:{closeAll(){this.showRegister=!1,this.showCodeInput=!1,this.showLogin=!1,this.showAuthModal=!1,this.showDashboard=!1,this.isRestore=!1,this.tempPassword=""},handleRegistered({phone:t,password:e}){this.registerPhone=t,this.tempPassword=e,this.showRegister=!1,this.showCodeInput=!0,this.isRestore=!1},handleRestore({phone:t}){this.registerPhone=t,this.tempPassword="",this.showLogin=!1,this.showCodeInput=!0,this.isRestore=!0},async handleVerified(t){this.authStore.setToken(t),await this.fetchAmoCrmData(),this.showCodeInput=!1,this.showDashboard=!0,this.isRestore=!1,this.tempPassword=""},async handleLoggedIn(t){this.authStore.setToken(t),await this.fetchAmoCrmData(),this.showLogin=!1,this.showAuthModal=!1,this.showDashboard=!0},async fetchAmoCrmData(){try{const t=await fetch("https://letsdancescores.tech/api/check_and_fetch_amocrm.php",{method:"POST",headers:{Authorization:`Bearer ${this.authStore.token}`,"Content-Type":"application/json"}}),e=await t.json();"success"===e.status?this.amocrmData=e.amocrm_response:(alert("Ошибка AmoCRM: "+e.message),this.amocrmData=null)}catch{alert("Ошибка сети при запросе AmoCRM"),this.amocrmData=null}},logout(){this.authStore.clearToken(),this.amocrmData=null,this.closeAll(),alert("Вы вышли из системы")},switchToSite(){this.showDashboard=!1},async checkToken(){if(this.authStore.token)try{const t=await fetch("https://letsdancescores.tech/api/check_token.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:this.authStore.token})}),e=await t.json();e.success?(await this.fetchAmoCrmData(),this.showDashboard=!0):this.logout()}catch{alert("Ошибка проверки токена"),this.logout()}}},mounted(){this.checkToken()}};const se=(0,u.A)(ee,[["render",a]]);var oe=se;const ne=(0,o.Ef)(oe);ne.use((0,n.Ey)()),ne.mount("#app")}},e={};function s(o){var n=e[o];if(void 0!==n)return n.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,s),i.exports}s.m=t,function(){var t=[];s.O=function(e,o,n,i){if(!o){var a=1/0;for(d=0;d<t.length;d++){o=t[d][0],n=t[d][1],i=t[d][2];for(var r=!0,c=0;c<o.length;c++)(!1&i||a>=i)&&Object.keys(s.O).every(function(t){return s.O[t](o[c])})?o.splice(c--,1):(r=!1,i<a&&(a=i));if(r){t.splice(d--,1);var l=n();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[o,n,i]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var o in e)s.o(e,o)&&!s.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.p="/siis/"}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,o){var n,i,a=o[0],r=o[1],c=o[2],l=0;if(a.some(function(e){return 0!==t[e]})){for(n in r)s.o(r,n)&&(s.m[n]=r[n]);if(c)var d=c(s)}for(e&&e(o);l<a.length;l++)i=a[l],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(d)},o=self["webpackChunkdancerus"]=self["webpackChunkdancerus"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],function(){return s(8764)});o=s.O(o)})();
//# sourceMappingURL=app.4432ae20.js.map